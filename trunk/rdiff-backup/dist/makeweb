#!/usr/bin/env python

import sys, os

def RunCommand(cmd):
	print cmd
	os.system(cmd)

webprefix = "/home/ben/misc/html/mirror/rdiff-backup/"

if not sys.argv[1:]:
	print 'Call with version number, as in "./makeweb 0.3.1"'
	print "to move new rpms and tarballs.  Now just remaking FAQ and man page."
	print
else:
	version = sys.argv[1]
	RunCommand("cp *%s* %s" % (version, webprefix))

RunCommand("rman -f html -r '' rdiff-backup.1 > %srdiff-backup.1.html"
		   % webprefix)
RunCommand("cp FAQ.wml CHANGELOG %s" % webprefix)


os.chdir(webprefix)
print "cd ", webprefix
if sys.argv[1:]:
	RunCommand("rm latest latest.rpm latest.tar.gz")
	RunCommand("ln -s *%s*rpm latest.rpm" % (version,))
	RunCommand("ln -s *%s*tar.gz latest.tar.gz" % (version,))
RunCommand("./Make")
